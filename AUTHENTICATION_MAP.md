# –ö–∞—Ä—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ diff-master

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **FastAPI-Users** —Å JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Bearer —Ç–æ–∫–µ–Ω—ã. –í—Å–µ API endpoints –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–æ–π `current_active_user`, —Ç—Ä–µ–±—É—é—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üîê Backend: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### 1. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `backend/app/auth.py` ‚ö†Ô∏è **–£–î–ê–õ–ò–¢–¨/–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  - `UserManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è)
  - `get_user_db()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `get_user_manager()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `bearer_transport` - Bearer —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –¥–ª—è JWT
  - `get_jwt_strategy()` - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è JWT —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
  - `auth_backend` - –±—ç–∫–µ–Ω–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - `fastapi_users` - —ç–∫–∑–µ–º–ø–ª—è—Ä FastAPIUsers
  - `current_active_user` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö endpoints (active=True, verified=True)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ dummy-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### `backend/app/models/user.py` ‚ö†Ô∏è **–û–°–¢–ê–í–ò–¢–¨ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  - `User` - –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `SQLAlchemyBaseUserTableUUID`
  - –ü–æ–ª—è: `id`, `email`, `hashed_password`, `is_active`, `is_superuser`, `is_verified`
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `backend/app/schemas/user.py` ‚ö†Ô∏è **–û–°–¢–ê–í–ò–¢–¨ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Pydantic —Å—Ö–µ–º—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  - `UserRead`, `UserCreate`, `UserUpdate`
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ API

---

### 2. API Endpoints —Å –∑–∞—â–∏—Ç–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

–í—Å–µ —Å–ª–µ–¥—É—é—â–∏–µ endpoints –∏—Å–ø–æ–ª—å–∑—É—é—Ç `user: User = Depends(current_active_user)`:

#### `backend/app/api/documents.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (8 —à—Ç—É–∫):
  - `POST /api/import` (—Å—Ç—Ä–æ–∫–∞ 39)
  - `GET /api/documents` (—Å—Ç—Ä–æ–∫–∞ 140)
  - `GET /api/documents/{id}` (—Å—Ç—Ä–æ–∫–∞ 193)
  - `GET /api/documents/{id}/structure` (—Å—Ç—Ä–æ–∫–∞ 235)
  - `GET /api/documents/{id}/articles` (—Å—Ç—Ä–æ–∫–∞ 257)
  - `DELETE /api/documents/{id}` (—Å—Ç—Ä–æ–∫–∞ 283)
  - `POST /api/documents/{id}/snapshot` (—Å—Ç—Ä–æ–∫–∞ 314)
  - `GET /api/documents/{id}/snapshots` (—Å—Ç—Ä–æ–∫–∞ 352)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/workspace.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (4 —à—Ç—É–∫–∏):
  - `POST /api/workspace/file` (—Å—Ç—Ä–æ–∫–∞ 29)
  - `GET /api/workspace/files` (—Å—Ç—Ä–æ–∫–∞ 140)
  - `GET /api/workspace/file/{id}` (—Å—Ç—Ä–æ–∫–∞ 157)
  - `DELETE /api/workspace/file/{id}` (—Å—Ç—Ä–æ–∫–∞ 178)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/edits.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (7 —à—Ç—É–∫):
  - `POST /api/edits/apply/phase1` (—Å—Ç—Ä–æ–∫–∞ 39)
  - `POST /api/edits/apply/phase2` (—Å—Ç—Ä–æ–∫–∞ 81)
  - `GET /api/edits/targets/{workspace_file_id}` (—Å—Ç—Ä–æ–∫–∞ 160)
  - `PUT /api/edits/target/{target_id}` (—Å—Ç—Ä–æ–∫–∞ 223)
  - `POST /api/edits/target` (—Å—Ç—Ä–æ–∫–∞ 309)
  - `DELETE /api/edits/target/{target_id}` (—Å—Ç—Ä–æ–∫–∞ 338)
  - `GET /api/edits/task/{task_id}` (—Å—Ç—Ä–æ–∫–∞ 411)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/search.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (2 —à—Ç—É–∫–∏):
  - `GET /api/search` (—Å—Ç—Ä–æ–∫–∞ 28)
  - `GET /api/search/articles` (—Å—Ç—Ä–æ–∫–∞ 76)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/diff.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (2 —à—Ç—É–∫–∏):
  - `GET /api/diff` (—Å—Ç—Ä–æ–∫–∞ 28)
  - `GET /api/diff/{diff_id}` (—Å—Ç—Ä–æ–∫–∞ 149)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/export.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (2 —à—Ç—É–∫–∏):
  - `POST /api/export/text` (—Å—Ç—Ä–æ–∫–∞ 29)
  - `POST /api/export/excel` (—Å—Ç—Ä–æ–∫–∞ 95)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

#### `backend/app/api/versions.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints** (3 —à—Ç—É–∫–∏):
  - `GET /api/versions` (—Å—Ç—Ä–æ–∫–∞ 27)
  - `GET /api/versions/{snapshot_id}` (—Å—Ç—Ä–æ–∫–∞ 59)
  - `POST /api/versions/commit` (—Å—Ç—Ä–æ–∫–∞ 165)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user

---

### 3. –†–æ—É—Ç–µ—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ app.py

#### `backend/app/app.py` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–°—Ç—Ä–æ–∫–∏ 41-65**: –†–æ—É—Ç–µ—Ä—ã FastAPI-Users
  - `fastapi_users.get_auth_router()` - `/auth/jwt/login`, `/auth/jwt/logout`
  - `fastapi_users.get_register_router()` - `/auth/register`
  - `fastapi_users.get_reset_password_router()` - `/auth/forgot-password`, `/auth/reset-password`
  - `fastapi_users.get_verify_router()` - `/auth/verify`, `/auth/request-verify-token`
  - `fastapi_users.get_users_router()` - `/users/me`, `/users/{id}`
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —ç—Ç–∏ —Ä–æ—É—Ç–µ—Ä—ã (—Å—Ç—Ä–æ–∫–∏ 41-65)

---

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `backend/app/config/settings.py` ‚ö†Ô∏è **–û–°–¢–ê–í–ò–¢–¨ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)**
- **–ö–ª–∞—Å—Å `SecuritySettings`** (—Å—Ç—Ä–æ–∫–∏ 44-52):
  - `SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT
  - `ALGORITHM` - –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏ (HS256)
  - `ACCESS_TOKEN_EXPIRE_MINUTES` - –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7 –¥–Ω–µ–π)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
- **–§–∞–π–ª**: `backend/alembic/versions/409b9558a51f_init_schema.py`
- **–¢–∞–±–ª–∏—Ü–∞ `user`** (—Å—Ç—Ä–æ–∫–∏ 28-37):
  - `id` (UUID, PK)
  - `email` (String, unique)
  - `hashed_password` (String)
  - `is_active` (Boolean)
  - `is_superuser` (Boolean)
  - `is_verified` (Boolean)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### –°–≤—è–∑–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π `user`:
- `audit_log.user_id` ‚Üí `user.id` (CASCADE)
- `base_document.user_id` ‚Üí `user.id` (CASCADE)
- `snapshot.user_id` ‚Üí `user.id` (CASCADE)
- `workspace_file.user_id` ‚Üí `user.id` (CASCADE)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `user_id` –Ω–∞ dummy user ID

---

## üé® Frontend: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### 1. –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `frontend/src/hooks/useAuthStore.ts` ‚ö†Ô∏è **–£–î–ê–õ–ò–¢–¨/–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Zustand store –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  - `user`, `token`, `isAuthenticated`, `isLoading`, `error`
  - –ú–µ—Ç–æ–¥—ã: `login()`, `register()`, `logout()`, `checkAuth()`, `clearError()`
  - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `localStorage` (–∫–ª—é—á `auth-storage`)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å (—É–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞)

---

### 2. API —Å–µ—Ä–≤–∏—Å

#### `frontend/src/services/api.ts` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–°—Ç—Ä–æ–∫–∏ 25-32**: Interceptor –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
  ```typescript
  api.interceptors.request.use((config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  });
  ```
- **–°—Ç—Ä–æ–∫–∏ 38-44**: Interceptor –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 401 (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login)
- **–°—Ç—Ä–æ–∫–∏ 63-122**: `authAPI` –æ–±—ä–µ–∫—Ç —Å –º–µ—Ç–æ–¥–∞–º–∏:
  - `login()` - POST `/auth/jwt/login`
  - `register()` - POST `/auth/register`
  - `requestVerify()` - POST `/auth/request-verify-token`
  - `logout()` - POST `/auth/jwt/logout`
  - `getMe()` - GET `/users/me`
- **–î–µ–π—Å—Ç–≤–∏–µ**: 
  - –£–¥–∞–ª–∏—Ç—å interceptor –¥–ª—è —Ç–æ–∫–µ–Ω–∞ (—Å—Ç—Ä–æ–∫–∏ 25-32)
  - –£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É 401 (—Å—Ç—Ä–æ–∫–∏ 38-44)
  - –£–¥–∞–ª–∏—Ç—å `authAPI` (—Å—Ç—Ä–æ–∫–∏ 63-122)

---

### 3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI

#### `frontend/src/pages/LoginPage.tsx` ‚ö†Ô∏è **–£–î–ê–õ–ò–¢–¨/–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  - –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `useAuthStore`
  - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/dashboard` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ—Å—Ç—É—é –∑–∞–≥–ª—É—à–∫—É

#### `frontend/src/pages/DashboardPage.tsx` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**:
  - –ò–º–ø–æ—Ä—Ç `useAuthStore` (—Å—Ç—Ä–æ–∫–∞ 13)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `user` –∏ `logout` (—Å—Ç—Ä–æ–∫–∞ 21)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useAuthStore`, —É–±—Ä–∞—Ç—å –∫–Ω–æ–ø–∫—É logout (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

### 4. –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤

#### `frontend/src/App.tsx` ‚ö†Ô∏è **–ò–ó–ú–ï–ù–ò–¢–¨**
- **–°—Ç—Ä–æ–∫–∏ 14-26**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `ProtectedRoute`
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `isAuthenticated`
  - –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ `/login` –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- **–°—Ç—Ä–æ–∫–∏ 29-45**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–°—Ç—Ä–æ–∫–∏ 58-97**: –í—Å–µ —Ä–æ—É—Ç—ã –æ–±–µ—Ä–Ω—É—Ç—ã –≤ `<ProtectedRoute>`
  - `/dashboard`
  - `/document/:id`
  - `/review/:workspaceFileId`
  - `/diff/:workspaceFileId`
  - `/edits`
- **–î–µ–π—Å—Ç–≤–∏–µ**: 
  - –£–¥–∞–ª–∏—Ç—å `ProtectedRoute` (—Å—Ç—Ä–æ–∫–∏ 14-26)
  - –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 29-45)
  - –£–±—Ä–∞—Ç—å –æ–±–µ—Ä—Ç–∫–∏ `<ProtectedRoute>` —Å–æ –≤—Å–µ—Ö —Ä–æ—É—Ç–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 58-97)
  - –£–¥–∞–ª–∏—Ç—å —Ä–æ—É—Ç `/login` (—Å—Ç—Ä–æ–∫–∞ 55)

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### Backend:
- **–§–∞–π–ª–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è**: 0 (–≤—Å–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- **–§–∞–π–ª–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**: 8
  - `auth.py` - –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ dummy user
  - `app.py` - —É–¥–∞–ª–∏—Ç—å auth —Ä–æ—É—Ç–µ—Ä—ã
  - `documents.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `workspace.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `edits.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `search.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `diff.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `export.py` - —É–¥–∞–ª–∏—Ç—å Depends
  - `versions.py` - —É–¥–∞–ª–∏—Ç—å Depends

### Frontend:
- **–§–∞–π–ª–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è**: 1
  - `LoginPage.tsx` (–∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∑–∞–≥–ª—É—à–∫—É)
- **–§–∞–π–ª–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è**: 4
  - `useAuthStore.ts` - —É–¥–∞–ª–∏—Ç—å/—É–ø—Ä–æ—Å—Ç–∏—Ç—å
  - `api.ts` - —É–¥–∞–ª–∏—Ç—å auth interceptor –∏ authAPI
  - `App.tsx` - —É–¥–∞–ª–∏—Ç—å ProtectedRoute –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
  - `DashboardPage.tsx` - —É–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useAuthStore` (user, logout)

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –≠—Ç–∞–ø 1: Backend
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å `backend/app/utils/auth_utils.py` —Å dummy user (—É–∂–µ —Å–æ–∑–¥–∞–Ω)
2. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å `auth.py` - –∑–∞–º–µ–Ω–∏—Ç—å `current_active_user` –Ω–∞ dummy user (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
3. ‚úÖ –£–¥–∞–ª–∏—Ç—å auth —Ä–æ—É—Ç–µ—Ä—ã –∏–∑ `app.py` (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
4. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å `Depends(current_active_user)` –∏–∑ –≤—Å–µ—Ö API endpoints
5. ‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç—å `user.id` –Ω–∞ `get_user_id()` –≤–æ –≤—Å–µ—Ö endpoints

### –≠—Ç–∞–ø 2: Frontend
1. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å `ProtectedRoute` –∏–∑ `App.tsx`
2. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å auth interceptor –∏–∑ `api.ts`
3. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å `authAPI` –∏–∑ `api.ts`
4. ‚ö†Ô∏è –£–ø—Ä–æ—Å—Ç–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å `useAuthStore.ts`
5. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å/–∑–∞–º–µ–Ω–∏—Ç—å `LoginPage.tsx`

### –≠—Ç–∞–ø 3: –û—á–∏—Å—Ç–∫–∞
1. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
2. ‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `fastapi-users` –∏–∑ `requirements.txt` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. ‚ö†Ô∏è –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –¢–∞–±–ª–∏—Ü–∞ `user` –≤ –ë–î –æ—Å—Ç–∞–µ—Ç—Å—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –í—Å–µ `user_id` –≤ –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dummy user ID
- JWT —Ç–æ–∫–µ–Ω—ã –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã, –Ω–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
